<script lang="ts">
	import Canvas from '../components/Canvas.svelte';
	import Add from '../components/Add.svelte';
	import PartyButton from '../components/buttons/PartyButton.svelte';
	import type { User } from '../shared/User';
	import { Global } from '../shared/Global';
	import { onMount } from 'svelte';

	onMount(() =>
	{
		Global.socket.on('connect', () =>
		{
			let image = 'data:image/jpeg;base64,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';
			let user = { id: Global.socket.id, image };
			Global.users.set(Global.socket.id, user);

			Global.socket.on('users', (users: User[]) =>
			{
				for (let user of users)
					Global.users.set(user.id, user);
			});

			Global.socket.on('newUser', (user: User) =>
			{
				Global.users.set(user.id, user);
			});

			Global.socket.emit('join', user);
		});
	});
</script>

<main class="flex justify-center items-center fixed">
	<div class="canvas flex justify-center items-center flex-col">
		<h1>Draw your avatar!</h1>
		<Canvas/>
	</div>
	<div class="start flex justify-center items-center flex-col">
		<Add width={16} height={16}/>
		<PartyButton type={'create'}/>
	</div>
</main>

<style>
	main
	{
		top: 0%;
		left: 0%;
		width: 100%;
		height: 100%;
		gap: 5rem;
	}

	.canvas
	{
		gap: 2rem;
	}

	.start
	{
		gap: 3rem;
	}
</style>
